Counts initialized sucessfully
TESTCASE 1 - Validate column/schema naming convention for RCA_UNFILL_SUPPLIER_LIMITED_PRODUCT_CDL When all the columns and data types are matched Then schema naming convention is verified and passed 

sucessfully connected
pass_tc_count incremented sucessfully
DDL VALIDATION IS PASSED - Column Name and Data Type is Matching
------------------------------------------------------------------------------------------------------------------------
TESTCASE 2 - No duplicate record displaying for each cin-dc,invoice number and supplier for any given invoice date  When searched with invoice date filter  Then each cin-dc,invoice number and supplier combination should have distinct record 
 
sucessfully connected
pass_tc_count incremented sucessfully
Dups Validation IS PASSED - No Duplicates Found
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   27 |                        27 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   64 |                        64 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |    3 |                         3 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |    6 |                         6 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   11 |                        11 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------
TESTCASE 1 - Validate column/schema naming convention for RCA_UNFILL_SUPPLIER_LIMITED_PRODUCT_CDL When all the columns and data types are matched Then schema naming convention is verified and passed 

sucessfully connected
pass_tc_count incremented sucessfully
DDL VALIDATION IS PASSED - Column Name and Data Type is Matching
------------------------------------------------------------------------------------------------------------------------


TESTCASE 2 - No duplicate record displaying for each cin-dc,invoice number and supplier for any given invoice date  When searched with invoice date filter  Then each cin-dc,invoice number and supplier combination should have distinct record 
 
sucessfully connected
pass_tc_count incremented sucessfully
Dups Validation IS PASSED - No Duplicates Found
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   27 |                        27 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   64 |                        64 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |    3 |                         3 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |    6 |                         6 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5602776 |   11 |                        11 |               1830 |
+----------------------------------+----------------+---------+------+---------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


*******************TESTCASE-03 : To verify whether the supplier type is correctly tagged When searched for any process date for any CIN and DC Then CF_Supplier_Type should be correctly tagged as 'CENTRALIZED','NONCENTRALIZED' or 'HUBSPOKE' *******************
sucessfully connected
Validation IS PASSED for Supplier Type - CENTRALIZED
sucessfully connected
Validation IS PASSED for Supplier Type - HUBSPOKE
sucessfully connected
Validation IS PASSED for Supplier Type - NON-CENTRALIZED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   Inv_Purchasing_Supplier | cf_supplier_type   | Inv_Buyer_Work_Field_Number   | Inv_Purchasing_Supplier_Sub_Group   |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+===========================+====================+===============================+=====================================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |                      2406 | NONCENTRALIZED     |                               |                                     |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |                      9726 | NONCENTRALIZED     |                               |                                     |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |                      2598 | NONCENTRALIZED     |                               |                                     |                547 |
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |                      2598 | NONCENTRALIZED     |                               |                                     |                547 |
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |                      2598 | NONCENTRALIZED     |                               | OPIOID                              |                547 |
+----------------------------------+----------------+---------+------+---------------------------+---------------------------+--------------------+-------------------------------+-------------------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------
pass_tc_count incremented sucessfully


TESTCASE 4 - To verify the Availability alert to identify product backlog When searched with process date for any material Then record should always display AA code except 950,995,980 

sucessfully connected
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   lf_aa_code |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+==============+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |          996 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |          992 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |          996 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |          996 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |          996 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+--------------------+
pass_tc_count incremented sucessfully


TESTCASE 5 - To verify whether supplier has limited inventory available to ship to Cardinal in last 30 days When records for both centralised and non-centralised suppliers are searched Then Network Received Quantity should be greater than or equal to 10% and less than or equal to 95% of ((4*Network Forecast) + Network Holdouts + Network Backorder)) 

sucessfully connected
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   CF_Network_Rec_Qty |   CF_Network_Forecast_Qty |   CF_Network_Backorder_Qty |   CF_Network_HoldOUT_Qty |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+======================+===========================+============================+==========================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |                  288 |                    127.15 |                          0 |                        0 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |                  360 |                    268.64 |                          9 |                        0 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |                  360 |                    415.56 |                         67 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |                  120 |                    154.99 |                          0 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |                  120 |                    215.83 |                          3 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+---------------------------+----------------------------+--------------------------+--------------------+
pass_tc_count incremented sucessfully


*******************TESTCASE-06 : To verify calculation for Network Received Quantity When searched for a particular process date, invoice date and CIN Then for centralised supplier, Network Received Quantity is calculated at CIN level And for non-centralised supplier, Network Received Quantity is calculated at CIN-shipping location level *******************
sucessfully connected
Validation Failed for CF_Supplier_Type='CENTRALIZED' ,5407 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Rec_Qty |   CF_Network_Rec_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+======================+===========================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413858718 |                    30 |                     90163 |                        24 |                  672 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413805866 |                   413 |                     90163 |                        24 |                  672 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413804703 |                    72 |                     90163 |                        24 |                  672 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3673480 |   24 |       7413804099 |                   260 |                     90163 |                        24 |                 2760 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3673506 |   18 |       7413856519 |                   297 |                     90163 |                        18 |                  408 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
sucessfully connected
Validation IS PASSED for Supplier Type - HUBSPOKE
sucessfully connected
Validation IS PASSED for Supplier Type - NON-CENTRALIZED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   cf_network_rec_qty |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+======================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |                  288 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |                  360 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |                  360 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |                  120 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |                  120 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------+--------------------+
sucessfully connected
Validation Failed for CF_Supplier_Type='NON-HUBSPOKE' ,2 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Rec_Qty |   CF_Network_Rec_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+======================+===========================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3536026 |   18 |       7413856245 |                  3116 |                     90990 |                        18 |                  120 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4372777 |    3 |       7413821467 |                   748 |                     90990 |                         3 |                  126 |                         0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+---------------------------+---------------+
------------------------------------------------------------------------------------------------------------------------


*******************TESTCASE-07 : To verify calculation for Network Forecast Quantity When searched for a particular process date, invoice date and CIN and forecast quantity is inspected Then for centralised supplier, Network Forecast Quantity is calculated at CIN level And for non-centralised supplier, Network Forecast Quantity is calculated at CIN-shipping location level *******************
sucessfully connected
Validation Failed for CF_Supplier_Type='CENTRALIZED' ,5406 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_MIN_MAX_Network_Forecast_Qty |   max_fcst |   min_fcst |   CF_Network_Forecast_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+===================================+============+============+================================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413858718 |                    30 |                     90163 |                        24 |                            458.91 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413805866 |                   413 |                     90163 |                        24 |                            458.91 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1161017 |   24 |       7413804703 |                    72 |                     90163 |                        24 |                            458.91 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3673480 |   24 |       7413804099 |                   260 |                     90163 |                        24 |                            387.92 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3673506 |   18 |       7413856519 |                   297 |                     90163 |                        18 |                            321.28 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
sucessfully connected
Validation Failed for CF_Supplier_Type='HUBSPOKE' ,15 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Rec_Qty |   CF_MIN_MAX_Network_Forecast_Qty |   max_fcst |   min_fcst |   CF_Network_Forecast_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+======================+===================================+============+============+================================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5715982 |   26 |       7413827261 |                   727 |                     90990 |                        26 |                   72 |                             33.21 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3536026 |   18 |       7413856245 |                  3116 |                     90990 |                        18 |                  120 |                             56.51 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3751138 |   26 |       7413826508 |                   411 |                     90990 |                        26 |                   84 |                             33.54 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5208269 |   26 |       7413832727 |                   517 |                     90990 |                        26 |                    7 |                              5.89 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4372777 |    3 |       7413821467 |                   748 |                     90990 |                         3 |                  126 |                             32.85 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
sucessfully connected
Validation Failed for CF_Supplier_Type='NON-CENTRALIZED' ,815 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Rec_Qty |   CF_MIN_MAX_Network_Forecast_Qty |   max_fcst |   min_fcst |   CF_Network_Forecast_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+======================+===================================+============+============+================================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2705440 |   32 |       7413872268 |                   532 |                      5909 |                        32 |                   12 |                              5.31 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4497848 |    3 |       7413821051 |                   222 |                      5866 |                         3 |                   24 |                             22.05 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4497848 |    3 |       7413821087 |                   504 |                      5866 |                         3 |                   24 |                             22.05 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4497848 |    3 |       7413821042 |                   912 |                      5866 |                         3 |                   24 |                             22.05 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4221750 |    8 |       7413874612 |                   342 |                      8834 |                         8 |                  179 |                             89.27 |        nan |        nan |                            nan |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+----------------------+-----------------------------------+------------+------------+--------------------------------+---------------+
------------------------------------------------------------------------------------------------------------------------


*******************TESTCASE-08 : To verify calculation for Network Backorder Quantity When searched for a particular process date, invoice date and CIN and backorder quantity is inspected Then for centralised supplier, Network Backorder Quantity is calculated at CIN level And for non-centralised supplier, Network Backorder Quantity is calculated at CIN-shipping location level *******************
sucessfully connected
Validation IS PASSED for Supplier Type - CENTRALIZED
sucessfully connected
Validation IS PASSED for Supplier Type - HUBSPOKE
sucessfully connected
Validation IS PASSED for Supplier Type - NON-CENTRALIZED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   cf_network_backorder_qty |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+============================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |                          0 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |                          9 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |                         67 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |                          0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |                          3 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+----------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------
pass_tc_count incremented sucessfully


*******************TESTCASE-09 : To verify calculation for Network Holdout Quantity When searched for a particular process date, invoice date and CIN and holdout quantity is inspected Then for centralised supplier, Network Holdout Quantity is calculated at CIN level And for non-centralised supplier, Network Holdout Quantity is calculated at CIN-shipping location level *******************
sucessfully connected
Validation Failed for CF_Supplier_Type='CENTRALIZED' ,119 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Holdout_Qty |   CF_Network_Holdout_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+==========================+===============================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3673480 |   24 |       7413804099 |                   260 |                     90163 |                        24 |                     1828 |                           254 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4987996 |   15 |       7413815016 |                    20 |                     90163 |                        15 |                        9 |                             6 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 4987996 |   18 |       7413854491 |                   616 |                     90163 |                        18 |                        9 |                             6 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5010103 |    9 |       7413866165 |                    90 |                     90163 |                         9 |                      632 |                           363 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5010103 |    9 |       7413867035 |                   121 |                     90163 |                         9 |                      632 |                           363 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
sucessfully connected
Validation IS PASSED for Supplier Type - HUBSPOKE
sucessfully connected
Validation Failed for CF_Supplier_Type='NON-CENTRALIZED' ,3 records, check error file and log for more details
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| Process_Date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_Network_Holdout_Qty |   CF_Network_Holdout_Qty_Calc |   value_match |
+==================================+================+=========+======+==================+=======================+===========================+===========================+==========================+===============================+===============+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5661665 |    3 |       7413820301 |                   130 |                     57637 |                         3 |                       10 |                             0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5661665 |    3 |       7413821844 |                   184 |                     57637 |                         3 |                       10 |                             0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 5661665 |    3 |       7413820657 |                   310 |                     57637 |                         3 |                       10 |                             0 |             0 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------------+-------------------------------+---------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 10 - All invoices in RCA 2 should not show short_code as '01' or short id as 'S' When searched for an invoice number and invoice line number for an invoice date #Then the rejection reason for the invoice should be null or 'Z6' Then either lf_shrt_id<>'S' and lf_short_code<>'01' 

sucessfully connected
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
| Process_date                     | Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER |   Inv_Purchasing_Supplier |   LF_Ship_To_Location_Num |   CF_CIN_Short_Qty |
+==================================+================+=========+======+==================+=======================+===========================+===========================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |       7413882030 |                  1242 |                      2406 |                         6 |                 41 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |       7413883271 |                   753 |                      2406 |                         6 |                 41 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |       7413885398 |                   251 |                      9726 |                        64 |                 41 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |       7413888136 |                   612 |                      9726 |                        64 |                 41 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |       7413853656 |                   172 |                      2598 |                        37 |                547 |
+----------------------------------+----------------+---------+------+------------------+-----------------------+---------------------------+---------------------------+--------------------+
pass_tc_count incremented sucessfully


TESTCASE 11 - All invoices in the table should have short code as not null When searched for a shorted invoice Then the value of LF_Short_Code should match with the source And LF_Short_Code should not be null 

Validationg : LF_Short_code should not be null for the shorted invoices
sucessfully connected
Validation IS PASSED
Validationg : LF_Short_code should matches with source
sucessfully connected
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   lf_short_code |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+=================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |              05 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |              05 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |              05 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |              05 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |              05 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+-----------------+--------------------+
pass_tc_count incremented sucessfully
------------------------------------------------------------------------------------------------------------------------


TESTCASE 12 - Verifying count of invoice in RCA2 When searching for any specific invoice date Then total number of invoices in RCA2 matches the count of invoices which was shorted due to limited product 

sucessfully connected
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
| process_date                     | invoice_date   |     cin |   dc |   lf_ship_to_location_num |   LF_AA_Code |   CF_Network_Rec_Qty |   CF_MIN_MAX_Network_Forecast_Qty |   CF_Network_Backorder_Qty |   CF_Network_HOLDOUT_Qty |   CF_CIN_Short_Qty |
+==================================+================+=========+======+===========================+==============+======================+===================================+============================+==========================+====================+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 3025616 |    6 |                         6 |          996 |                  288 |                             96.55 |                          0 |                        0 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 1316470 |   64 |                        64 |          992 |                  360 |                            356.19 |                          9 |                        0 |                 41 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   37 |                        37 |          996 |                  360 |                            296.31 |                         67 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |   19 |                        19 |          996 |                  120 |                            133.14 |                          0 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
| 2025-03-18 13:20:02.427476+00:00 | 2025-03-18     | 2579472 |    3 |                         3 |          996 |                  120 |                            184.63 |                          3 |                        0 |                547 |
+----------------------------------+----------------+---------+------+---------------------------+--------------+----------------------+-----------------------------------+----------------------------+--------------------------+--------------------+
pass_tc_count incremented sucessfully


Total Number of Test Cases : 12
Total Number of pass Test Cases : 11
Total Number of failed Test Cases : 1
