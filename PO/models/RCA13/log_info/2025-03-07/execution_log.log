TESTCASE 1 - Validate column/schema naming convention for RCA_Key_Customer_Demand table, When all the columns and data types are matched,Then schema naming convention is verified and passed 

DDL VALIDATION IS PASSED - Column Name and Data Type is Matching
------------------------------------------------------------------------------------------------------------------------


TESTCASE 2 - No duplicate record should display for any line item in the invoice for same process date When searched with invoice date filter Then each cin-dc-Invoice No.-Invoiceline item no combination should have distinct record 
 
Dups Validation IS PASSED - No Duplicates Found
Records for Top 5 CINs
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
| Invoice_Date   |     cin |   dc |   Invoice_Number |   INVOICE_LINE_NUMBER | Process_Date                     |   CF_CIN_Short_Qty |
+================+=========+======+==================+=======================+==================================+====================+
| 2025-03-07     | 5242169 |   34 |       7412522737 |                   714 | 2025-03-07 14:20:02.287117+00:00 |               1951 |
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
| 2025-03-07     | 5242169 |   34 |       7412521589 |                   325 | 2025-03-07 14:20:02.287117+00:00 |               1951 |
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
| 2025-03-07     | 5242169 |   34 |       7412516643 |                   702 | 2025-03-07 14:20:02.287117+00:00 |               1951 |
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
| 2025-03-07     | 5242169 |   34 |       7412522304 |                   495 | 2025-03-07 14:20:02.287117+00:00 |               1951 |
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
| 2025-03-07     | 5242169 |   34 |       7412516247 |                   291 | 2025-03-07 14:20:02.287117+00:00 |               1951 |
+----------------+---------+------+------------------+-----------------------+----------------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 3 - Validate the Customers must fall under key account When validated customers for the unfilled invoice listed under RCA13 Then the customers must have affliation code as Affiliation Level1 Customer Number in  (7007000590,7007000642,7007001133,7007002000,7007002221,7007002455,7007002938,7007003115,7007003383,7007003709,7007004252,7007300019,7007308188,7007308323,7007308345,7007308347,7007312268,7007311906) Or Affiliation Level2 Customer Number in (7007063525,7007003522,7007002462) Or Affiliation Level3 Customer Number in (7007001456,7007003706,7007003705,7007000636) 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_L01_afltn_num |   LF_L02_afltn_num |   LF_L03_afltn_num |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+====================+====================+====================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |         7007000590 |         7007000495 |         7007000495 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |         7007000590 |         7007000495 |         7007000495 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |         7007000590 |         7007000495 |         7007000495 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |         7007000590 |         7007000495 |         7007000495 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |         7007000590 |         7007000495 |         7007000495 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------+--------------------+--------------------+


TESTCASE 4 - Validate the rejection reason code for RCA 13 When validate rejection code for any given process date Then LF_VBAP_SHRT_ID is not (Z8, ZD) and Short_code is not (01,IO) 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_Ship_to_Location_Num |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+===========================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 5 - Validate Ship_to_Location_Num for the shorted invoices  When validate LF-Ship_to_Location_Num for the unfilled invoices  Then LF_Ship_to_Location_Num should not be 99 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_Ship_to_Location_Num |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+===========================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |                        34 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 6 - Validate ordered qty does not fall under regular demand  When searched with a given process dates for the shorted invoices  Then sum of order qty for ship to customer shorted invoice should be equal or greater than average + variance for last 16wks for ship to customer if its standard deviation was greater than 0 OR sum of order qty of Affiliation level1 shorted invoice should be equal or greater than average + variance for last 16wks for Affiliation level1 if its standard deviation was greater than 0 OR sum of order qty for ship to customer should be greater than 2 times of 16 week's average order if its standard deviation was 0 OR sum of order qty for Affiliation level1 should be greater than 2 times of 16 week's average order if its standard deviation was 0 OR sum of order qty for ship to customer should be greater than 3 times of 16 week's average of ship to customer OR sum of order qty for Affliation1 level should be greater than than 3 times of 16 week's average of Affliation1 level OR demand should  not be there from customer in last 8 weeks on cin-ship_to_Customer level 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   CF_Sum_Order_Qty_Ship_to_Cust |   CF_Sum_Order_Qty_Afltn |   CF_Average_16week_Order_Qty_Ship_to_Cust |   CF_Average_16week_Order_Qty_Afltn |   CF_STDDEV_Affiliation1_CIN_Qty |   CF_STDDEV2_Affiliation1_CIN_Qty |   CF_STDDEV_ShiptoCustomer_CIN_Qty |   CF_STDDEV2_ShiptoCustomer_CIN_Qty |   CF_Customer_Order_8weeks_Flag |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+=================================+==========================+============================================+=====================================+==================================+===================================+====================================+=====================================+=================================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |                               1 |                      254 |                                       9.76 |                               48.46 |                            59.42 |                            118.84 |                               6.48 |                               12.96 |                               1 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |                               2 |                      254 |                                       2    |                               48.46 |                            59.42 |                            118.84 |                               1.15 |                                2.3  |                               1 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |                               1 |                      254 |                                       1.83 |                               48.46 |                            59.42 |                            118.84 |                               0.69 |                                1.38 |                               1 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |                               1 |                      254 |                                       1.2  |                               48.46 |                            59.42 |                            118.84 |                               0.4  |                                0.8  |                               1 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |                               2 |                      254 |                                       2    |                               48.46 |                            59.42 |                            118.84 |                               0    |                                0    |                               0 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------------+--------------------------+--------------------------------------------+-------------------------------------+----------------------------------+-----------------------------------+------------------------------------+-------------------------------------+---------------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 7 - Validate Ordered qty at DC level should be greater than order point qty When searched for any Process date at DC level Then Sum of order quantity for a DC should be greater than order point qty 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   SAP_SHIP_TO_CUSTOMER_NUMBER |   CF_Sum_Order_Qty_Ship_to_Cust |   totsum |   countqty | LF_CUSTOMER_ORDER_DATE   |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+===============================+=================================+==========+============+==========================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |                    2150135971 |                               1 |        1 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |                    2150135914 |                               2 |        2 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |                    2150135954 |                               1 |        1 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |                    2150136004 |                               1 |        1 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |                    2150135950 |                               2 |        2 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+---------------------------------+----------+------------+--------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 8 - Validate the sum order quantity for affiliation for RCA 13  When sum of ordered qty of affiliation level1 calculated on distinct order date for a given process date  Then CF_Sum_Order_Qty_Afltn in RCA13 table is calculated as sum of order qty on distinct order date on cin-dc-affiliation level1 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_L01_AFLTN_NUM |   CF_Sum_Order_Qty_Afltn |   totsum |   countqty | LF_CUSTOMER_ORDER_DATE   |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+====================+==========================+==========+============+==========================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |         7007000590 |                      254 |      254 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |         7007000590 |                      254 |      254 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |         7007000590 |                      254 |      254 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |         7007000590 |                      254 |      254 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |         7007000590 |                      254 |      254 |          1 | 2025-03-06               |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+--------------------------+----------+------------+--------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 9 - Validate the Average order quantity of last 16 weeks for ship_to_customer for RCA 13  When average ordered qty of ship_to_customer for the last 16 weeks calculated on distinct order date for a given process date  Then CF_Average_16week_Order_Qty_Ship_to_Cust is calculated as the average of order quantity on distinct order date for a given cin and ship_to_customer_number 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   SAP_SHIP_TO_CUSTOMER_NUMBER |   CF_Average_16week_Order_Qty_Ship_to_Cust |   totsum |   countqty |   Average |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+===============================+============================================+==========+============+===========+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412525076 |                   615 | 5242169 |    6 |                    2150225061 |                                       1.63 |       31 |         19 |      1.63 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412514553 |                  1203 | 5242169 |    8 |                    2150134795 |                                       2.69 |       35 |         13 |      2.69 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412480088 |                   364 | 5242169 |   43 |                    2150134324 |                                       2.53 |       86 |         34 |      2.53 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412530073 |                   563 | 5242169 |    6 |                    2150132588 |                                       4.6  |       92 |         20 |      4.6  |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412502976 |                   313 | 5242169 |   26 |                    2150226148 |                                       2.7  |       27 |         10 |      2.7  |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-------------------------------+--------------------------------------------+----------+------------+-----------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 10 - Validate the Average order quantity of last 16 weeks for affiliation for RCA 13  When average ordered qty of affiliation for the last 16 weeks calculated on distinct order date for a given process date  Then CF_Average_16week_Order_Qty_Afltn is calculated as the average of order quantity on distinct order date for a given cin, dc and affiliation level 1 

Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_L01_afltn_num |   CF_Average_16week_Order_Qty_Afltn |   totsum |   countqty |   Average |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+====================+=====================================+==========+============+===========+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412493522 |                   572 | 5242169 |   18 |         7007000590 |                               42.65 |     4478 |        105 |     42.65 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412503614 |                   502 | 5242169 |   18 |         7007000590 |                               42.65 |     4478 |        105 |     42.65 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412470333 |                   442 | 5242169 |    3 |         7007000590 |                              190.11 |    21482 |        113 |    190.11 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412472898 |                   177 | 5242169 |    3 |         7007000590 |                              190.11 |    21482 |        113 |    190.11 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412473455 |                   552 | 5242169 |    3 |         7007000590 |                              190.11 |    21482 |        113 |    190.11 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+--------------------+-------------------------------------+----------+------------+-----------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 11 - Validate the Variance and Standard deviation of order quantity for ship_to_customer for RCA 13  When standard deviation of ordered qty of ship_to_customer calculated on distinct order date for a given process date  And variance of ordered qty of ship_to_customer calculated on distinct order date for a given process date  Then CF_STDDEV_ShiptoCustomer_CIN_Qty and CF_STDDEV2_ShiptoCustomer_CIN_Qty is calculated as the stdev and variance of order quantity on distinct order date for a given cin and ship_to_customer_number 

Validationg : standard deviation of ordered qty of ship_to_customer calculated on distinct order date for a given process date
Validation IS PASSED
Validationg : variance of ordered qty of ship_to_customer calculated on distinct order date for a given process date
Validation IS PASSED
Records for Top 5 CINs
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
| Invoice_Date   | Process_Date                     |     CIN |   Invoice_Number |   INVOICE_LINE_NUMBER |   SAP_SHIP_TO_CUSTOMER_NUMBER |   DC |   CF_STDDEV_ShiptoCustomer_CIN_Qty |   CF_STDDEV2_ShiptoCustomer_CIN_Qty |   CF_CIN_Short_Qty |
+================+==================================+=========+==================+=======================+===============================+======+====================================+=====================================+====================+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412522737 |                   714 |                    2150135971 |   34 |                               6.48 |                               12.96 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412521589 |                   325 |                    2150135914 |   34 |                               1.15 |                                2.3  |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412516643 |                   702 |                    2150135954 |   34 |                               0.69 |                                1.38 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412522304 |                   495 |                    2150136004 |   34 |                               0.4  |                                0.8  |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412516247 |                   291 |                    2150135950 |   34 |                               0    |                                0    |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+------------------------------------+-------------------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 12 - Validate the Variance and Standard deviation order quantity for affiliation1 level for RCA 13  When standard deviation of ordered qty of affiliation1 level calculated on distinct order date for a given process date  And variance of ordered qty of affiliation1 level calculated on distinct order date for a given process date  Then CF_STDDEV_Affiliation1_CIN_Qty and CF_STDDEV2_Affiliation1_CIN_Qty is calculated as the stdev and variance of order quantity on distinct order date for a given cin, dc and affiliation1 level 

Validationg : standard deviation of ordered qty of ship_to_customer calculated on distinct order date for a given process date
Validation IS PASSED
Validationg : variance of ordered qty of ship_to_customer calculated on distinct order date for a given process date
Validation IS PASSED
Records for Top 5 CINs
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
| Invoice_Date   | Process_Date                     |     CIN |   Invoice_Number |   INVOICE_LINE_NUMBER |   LF_L01_afltn_num |   DC |   CF_STDDEV_Affiliation1_CIN_Qty |   CF_STDDEV2_Affiliation1_CIN_Qty |   CF_CIN_Short_Qty |
+================+==================================+=========+==================+=======================+====================+======+==================================+===================================+====================+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412522737 |                   714 |         7007000590 |   34 |                            59.42 |                            118.84 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412521589 |                   325 |         7007000590 |   34 |                            59.42 |                            118.84 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412516643 |                   702 |         7007000590 |   34 |                            59.42 |                            118.84 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412522304 |                   495 |         7007000590 |   34 |                            59.42 |                            118.84 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412516247 |                   291 |         7007000590 |   34 |                            59.42 |                            118.84 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+--------------------+------+----------------------------------+-----------------------------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 13 - Validate the demand in last 8 weeks for RCA 13  When validated whether any demand was there from customer in last 8 weeks on cin-ship_to_Customer level  Then CF_Customer_Order_8weeks_flag is calculated as demand from customer in last 8 weeks 

Validation IS PASSED
Records for Top 5 CINs
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
| Invoice_Date   | Process_Date                     |     CIN |   Invoice_Number |   INVOICE_LINE_NUMBER |   SAP_SHIP_TO_CUSTOMER_NUMBER |   DC |   CF_Customer_Order_8weeks_Flag |   Flag |   countdte |   CF_CIN_Short_Qty |
+================+==================================+=========+==================+=======================+===============================+======+=================================+========+============+====================+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412503238 |                   311 |                    2150131487 |   26 |                               1 |      1 |         21 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412531726 |                   493 |                    2150228341 |   32 |                               1 |      1 |         27 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412482406 |                   552 |                    2150222919 |   26 |                               1 |      1 |         12 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412503463 |                   975 |                    2150131544 |   26 |                               1 |      1 |         27 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
| 2025-03-07     | 2025-03-07 14:20:02.287117+00:00 | 5242169 |       7412481036 |                   248 |                    2150134337 |   43 |                               1 |      1 |          6 |               1951 |
+----------------+----------------------------------+---------+------------------+-----------------------+-------------------------------+------+---------------------------------+--------+------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 14 - Validate short codes for the invoices in RCA13 is not null and matches with the source Billing Model  When validate short codes for any given process date  Then LF_Short_code should not be null or blank for the shorted invoices  And LF_Short_code matches Short_Code in Billing Model 

Validationg : LF_Short_code should not be null for the shorted invoices
Validation IS PASSED
Validationg : LF_Short_code matches Short_Code in Billing Model
Validation IS PASSED
Records for Top 5 CINs
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_Short_Code |   CF_CIN_Short_Qty |
+==================================+================+==================+=======================+=========+======+=================+====================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522737 |                   714 | 5242169 |   34 |              05 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412521589 |                   325 | 5242169 |   34 |              05 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516643 |                   702 | 5242169 |   34 |              05 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412522304 |                   495 | 5242169 |   34 |              05 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412516247 |                   291 | 5242169 |   34 |              05 |               1951 |
+----------------------------------+----------------+------------------+-----------------------+---------+------+-----------------+--------------------+
------------------------------------------------------------------------------------------------------------------------


TESTCASE 15 - Validate short codes for the invoices in RCA13 is not null and matches with the source Billing Model  When validate short codes for any given process date  Then LF_Short_code should not be null or blank for the shorted invoices  And LF_Short_code matches Short_Code in Billing Model 

Validation Failed for ,17026 records, check error file and log for more details
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
| Process_Date                     | Invoice_Date   |   Invoice_Number |   INVOICE_LINE_NUMBER |     CIN |   DC |   LF_Ship_to_Location_Num |   LF_AA_Code |   SAP_SHIP_TO_CUSTOMER_NUMBER |   CF_Sum_Order_Qty_Ship_to_Cust |   CF_Average_16week_Order_Qty_Ship_to_Cust |   CF_STDDEV2_ShiptoCustomer_CIN_Qty |   LF_L01_afltn_num |   LF_L02_afltn_num |   LF_L03_afltn_num |   CF_Sum_Order_Qty_Afltn |   CF_Average_16week_Order_Qty_Afltn |   CF_STDDEV2_Affiliation1_CIN_Qty |   CF_STDDEV_ShiptoCustomer_CIN_Qty |   CF_Customer_Order_8weeks_Flag | CF_Customer_Demand_RCA     | Process_Date_1                   | Invoice_Date_1   |   Invoice_Number_1 |   INVOICE_LINE_NUMBER_1 |   CIN_1 |   DC_1 |   LF_Ship_to_Location_Num_1 |   LF_AA_Code_1 |   SAP_SHIP_TO_CUSTOMER_NUMBER_1 |   CF_Sum_Order_Qty_Ship_to_Cust_1 |   CF_Average_16week_Order_Qty_Ship_to_Cust_1 |   CF_STDDEV2_ShiptoCustomer_CIN_Qty_1 |   LF_L01_afltn_num_1 |   LF_L02_afltn_num_1 |   LF_L03_afltn_num_1 |   CF_Sum_Order_Qty_Afltn_1 |   CF_Average_16week_Order_Qty_Afltn_1 |   CF_STDDEV2_Affiliation1_CIN_Qty_1 |   CF_STDDEV_ShiptoCustomer_CIN_Qty_1 |   CF_Customer_Order_8weeks_Flag_1 | CF_Customer_Demand_RCA_1   |
+==================================+================+==================+=======================+=========+======+===========================+==============+===============================+=================================+============================================+=====================================+====================+====================+====================+==========================+=====================================+===================================+====================================+=================================+============================+==================================+==================+====================+=========================+=========+========+=============================+================+=================================+===================================+==============================================+=======================================+======================+======================+======================+============================+=======================================+=====================================+======================================+===================================+============================+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412467891 |                   302 | 5811575 |   10 |                        10 |          996 |                    2150228988 |                               4 |                                       1.96 |                                2.46 |         7007000642 |         7007000565 |         7007000565 |                       81 |                                9.74 |                             25.18 |                               1.23 |                               1 | Demand Issue - Key Account | 2025-03-07 14:20:02.287117+00:00 | 2025-03-07       |         7412467891 |                     302 | 5811575 |     10 |                          10 |            996 |                      2150228988 |                                 4 |                                         1.96 |                                  2.46 |           7007000642 |           7007000565 |           7007000565 |                         81 |                                  9.74 |                               25.18 |                                 1.23 |                                 1 | Demand Issue - Key Account |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412468837 |                   492 | 5811575 |   10 |                        10 |          996 |                    2150136534 |                               4 |                                       2.2  |                                4.84 |         7007000642 |         7007000565 |         7007000565 |                       81 |                                9.74 |                             25.18 |                               2.42 |                               1 | Demand Issue - Key Account | 2025-03-07 14:20:02.287117+00:00 | 2025-03-07       |         7412468837 |                     492 | 5811575 |     10 |                          10 |            996 |                      2150136534 |                                 4 |                                         2.2  |                                  4.84 |           7007000642 |           7007000565 |           7007000565 |                         81 |                                  9.74 |                               25.18 |                                 2.42 |                                 1 | Demand Issue - Key Account |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412468006 |                   369 | 4279311 |   10 |                        10 |          996 |                    2150228886 |                               1 |                                       0    |                                0    |         7007000642 |         7007000565 |         7007000565 |                       18 |                               13.08 |                             19.26 |                               0    |                               0 | Demand Issue - Key Account | 2025-03-07 14:20:02.287117+00:00 | 2025-03-07       |         7412468006 |                     369 | 4279311 |     10 |                          10 |            996 |                      2150228886 |                                 1 |                                         0    |                                  0    |           7007000642 |           7007000565 |           7007000565 |                         18 |                                 13.08 |                               19.26 |                                 0    |                                 0 | Demand Issue - Key Account |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412468452 |                   526 | 5888219 |   10 |                        10 |          996 |                    2150228889 |                               1 |                                       2    |                                1.64 |         7007000642 |         7007000565 |         7007000565 |                       30 |                                9.11 |                             19.06 |                               0.82 |                               1 | Demand Issue - Key Account | 2025-03-07 14:20:02.287117+00:00 | 2025-03-07       |         7412468452 |                     526 | 5888219 |     10 |                          10 |            996 |                      2150228889 |                                 1 |                                         2    |                                  1.64 |           7007000642 |           7007000565 |           7007000565 |                         30 |                                  9.11 |                               19.06 |                                 0.82 |                                 1 | Demand Issue - Key Account |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
| 2025-03-07 14:20:02.287117+00:00 | 2025-03-07     |       7412468282 |                   136 | 3805447 |   10 |                        10 |          992 |                    2057201235 |                               2 |                                       0    |                                0    |         7007004252 |         7007000515 |         7007000516 |                        2 |                                0    |                              0    |                               0    |                               0 | Demand Issue - Key Account | 2025-03-07 14:20:02.287117+00:00 | 2025-03-07       |         7412468282 |                     136 | 3805447 |     10 |                          10 |            992 |                      2057201235 |                                 2 |                                         0    |                                  0    |           7007004252 |           7007000515 |           7007000516 |                          2 |                                  0    |                                0    |                                 0    |                                 0 | Demand Issue - Key Account |
+----------------------------------+----------------+------------------+-----------------------+---------+------+---------------------------+--------------+-------------------------------+---------------------------------+--------------------------------------------+-------------------------------------+--------------------+--------------------+--------------------+--------------------------+-------------------------------------+-----------------------------------+------------------------------------+---------------------------------+----------------------------+----------------------------------+------------------+--------------------+-------------------------+---------+--------+-----------------------------+----------------+---------------------------------+-----------------------------------+----------------------------------------------+---------------------------------------+----------------------+----------------------+----------------------+----------------------------+---------------------------------------+-------------------------------------+--------------------------------------+-----------------------------------+----------------------------+
------------------------------------------------------------------------------------------------------------------------


Total Number of TestCases : 15
Total Number of pass TestCases : 14
Total Number of failed TestCases : 1
TESTCASE 15 - Validate short codes for the invoices in RCA13 is not null and matches with the source Billing Model  When validate short codes for any given process date  Then LF_Short_code should not be null or blank for the shorted invoices  And LF_Short_code matches Short_Code in Billing Model 

There is exception while running TESTCASE-15, check execution_log_error.log file
------------------------------------------------------------------------------------------------------------------------
